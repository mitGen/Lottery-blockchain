# Lottery-blockchain
Lottery in blockchain

Разработка лотереи, которая базируется на технологии блокчейн. Это позволит прозрачно проводить лотерею и гарантировать ее честность.

Основная идея заключается в том, что в блокчейне размещен смарт-контракт, который представляет из себя лотерею. Смарт-контракт активен с момента размещения и на протяжении следующей недели после размещения. В течении этого времени можно перевести на адрес смарт-контракта сумму в размере 0.2 ETH. Если сумма перевода меньше — то такой адрес не участвует в лотереи. Деньги остаются на счету смарт-контракта. Если сумма перевода была больше 0.2 ETH, то такой адрес в лотерее участвует, деньги также остаются на счету смарт-контракта. Смарт-контракт активен либо до момента окончания времени (одной недели) или до выполнения 10 платежей (в зависимости от того, какое событие наступит раньше).

После того, как смарт-контракт перестает быть активным (из-за выполнения 10 платежей или после окончания времени действия) он должен ожидать транзакции любого размера с адреса owner. Именно эта транзакция должна запустить проверку на то является ли самарт-контракт активным и если он таковым не будет, то запустить процедуру розыгрыша и выплаты вознаграждения по результатам лотереи. Желательно, перед проведением транзакции проверять активен ли смарт-контракт. Предполагается, что за функциональность отправки финальной транзакции, проверки активности смарт-контракта будет отвечать микросервис.

Определение победителя необходимо реализовать на основе псевдослучайного числа. Например, использовать hash сумму одного из последних блоков.

Теперь о лотерее, схема распределения денег представлена на рис. 1. То есть, если пользователь забросил 0.2 ETH, то он может выиграть 1 ETH. Если участвуют все 10 человек — то вероятность выигрыша для каждого адреса составляет 10%. Если выполнить несколько транзакций (пополнить адрес смарт-контракта на 0.2. ETH) то можно увеличить свои шансы на выигрыш, так как считаются все переводы средств (не обязательно уникальные).

Рис. 1.
Если одна неделя активного периода смарт-контракта прошла и нет ни одного участника лотереи, то розыгрыш не проводится. Если число участников меньше чем 10, то выигрыш составляет половину от суммы перевода участников. Например, для 5-и участников — общая сумма составит 1 ETH, поэтому будет разыграно в лотерею 0.5 ETH

При размещении смарт-контракта указывается адрес Owner на который будет перечислены средства, которые остаются в остатке после выплаты выигрыша (по размеру — такая же сумма).

Фактически требуется подготовить сервис, который состоит из одного смарт-контракта размещенного в тестовой сети Ethereum и сервиса который фактически представляет из себя API-сервер, который по соответствующим запросам выдает информацию о состоянии смарт-контракта.


Short description about API

PATH: host/api/info

Method GET — get brief information about lottery

Expected data:
{
	description: text,
	address_input: number,
	address_owner: number,
	up_to_time: datetime,
	lottery_is_active: boolean
}


PATH: host/api/payments

Method GET — get list of member (up to 10 members)

Expected data:
{
	{
		address: number,
		transfer: number,
		time: datetime,
	},
	{
		address: number,
		transfer: number,
		time: datetime,
	}
}

PATH: host/api/inactive-payments

Method GET — get list of inactive member
Expected data:
{
	{
		address: number,
		transfer: number,
		time: datetime,
	},
	{
		address: number,
		transfer: number,
		time: datetime,
	}
}


PATH: host/api/result

Method GET — get winner

Expected data:
{
	{
		address: str,
		total: int,
		time: datetime,
		result: boolean
	}
}
